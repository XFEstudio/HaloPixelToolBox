<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="HaloPixelToolBox.Views.AppShellPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:HaloPixelToolBox.Views"
    xmlns:add="using:XFEExtension.NetCore.WinUIHelper.Utilities.Addition"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d" Loaded="Page_Loaded">

    <Grid x:Name="mainGrid">
        <ContentDialog x:Name="upgradeDialog" Title="更新新版本" Content="{x:Bind ViewModel.UpgradeContentText, Mode=OneWay}" PrimaryButtonText="更新" SecondaryButtonText="忽略此版本" CloseButtonText="取消" DefaultButton="Primary"/>
        <ContentDialog x:Name="closeDialog" Title="退出花再工具箱" PrimaryButtonText="确定" SecondaryButtonText="取消" DefaultButton="Primary">
            <StackPanel Spacing="10" Orientation="Vertical">
                <TextBlock Text="确认退出工具箱吗？"/>
                <RadioButtons SelectedIndex="{x:Bind ViewModel.SelectedIndex, Mode=TwoWay}">
                    <RadioButton Content="最小化到托盘" Tag="MinimizeToTray"/>
                    <RadioButton Content="退出应用" Tag="ExitApp"/>
                </RadioButtons>
                <CheckBox Margin="0,20,0,0" Content="记住我的选择，不再询问" IsChecked="{x:Bind ViewModel.NeverAskAgainWhenClose, Mode=TwoWay}"/>
            </StackPanel>
        </ContentDialog>
        <Grid x:Name="appTitleBar" Canvas.ZIndex="1" Height="{Binding ElementName=navigationView, Path=CompactPaneLength}" IsHitTestVisible="True" VerticalAlignment="Top">
            <Image Source="/Assets/icon.png" HorizontalAlignment="Left" Width="16" Height="16" Margin="10,0,0,0"/>
            <TextBlock Text="花再音响工具箱" VerticalAlignment="Center" TextWrapping="NoWrap" Margin="38,0,0,0"/>
        </Grid>
        <Grid x:Name="rightPanelGrid" Canvas.ZIndex="2" Margin="0,50,0,0">
            <Grid.TranslationTransition>
                <Vector3Transition/>
            </Grid.TranslationTransition>
            <StackPanel x:Name="messageStackPanel" Margin="0,5,0,0" VerticalAlignment="Top" HorizontalAlignment="Center"/>
        </Grid>
        <Grid x:Name="globalLoadingGrid" Canvas.ZIndex="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Background="{ThemeResource SmokeFillColorDefaultBrush}" Visibility="Collapsed">
            <Grid VerticalAlignment="Center" HorizontalAlignment="Center" CornerRadius="15" Padding="100">
                <Grid.Background>
                    <SolidColorBrush Color="Black" Opacity="0.5"/>
                </Grid.Background>
                <StackPanel Spacing="30">
                    <TextBlock x:Name="globalLoadingTextBlock" Text="加载中..." Foreground="White" FontSize="34" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                    <ProgressRing IsActive="True" Width="60" Height="60" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Grid>
        <NavigationView x:Name="navigationView" IsBackButtonVisible="Collapsed" Canvas.ZIndex="0" IsBackEnabled="{x:Bind ViewModel.CanGoBack, Mode=OneWay}" IsSettingsVisible="False" DisplayModeChanged="NavigationView_DisplayModeChanged" PaneOpening="NavigationView_PaneOpening" PaneOpened="NavigationView_PaneOpened" PaneClosing="NavigationView_PaneClosing" PaneClosed="NavigationView_PaneClosed">
            <NavigationView.MenuItems>
                <NavigationViewItem Content="网易云歌词" add:NavigationAddition.NavigateTo="HaloPixelToolBox.Views.CloudMusicLyricsToolPage">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE8D6;"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <!--在此处添加导航栏页面-->
            </NavigationView.MenuItems>

            <NavigationView.FooterMenuItems>
                <StackPanel Orientation="Horizontal" Margin="-4,0,0,0" Spacing="4">
                    <PersonPicture ProfilePicture="{x:Bind ViewModel.UserTile}" Height="25" Width="25" HorizontalAlignment="Center"/>
                    <TextBlock Text="{x:Bind ViewModel.UserName, Mode=OneWay}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="8,0,0,0"/>
                </StackPanel>
                <NavigationViewItem Content="设置" add:NavigationAddition.NavigateTo="HaloPixelToolBox.Views.SettingPage">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE713;"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.FooterMenuItems>
            <Grid x:Name="loadingGrid">
                <Frame Padding="56,24,56,0" x:Name="navigationFrame"/>
            </Grid>
        </NavigationView>
    </Grid>
</Page>
